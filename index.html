<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Login Seguro - Sistema de Herramientas</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        :root {
            --bg: #f0f0ff;
            --header: #6a1a8c;
            --card-bg: #ffffff;
            --accent: #8a2be2;
        }

        body {
            background-color: var(--bg);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .login-card {
            width: 100%;
            max-width: 420px;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            background: var(--card-bg);
        }

        .login-header {
            background: var(--header);
            color: #fff;
            padding: 1.25rem 1rem;
            text-align: center;
            font-weight: 700;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: .5rem;
        }

        .brand-icon {
            font-size: 1.25rem;
            color: var(--accent);
            background: rgba(255, 255, 255, 0.08);
            border-radius: .5rem;
            padding: .25rem .5rem;
        }

        label.form-label {
            color: #333;
            font-weight: 600;
        }

        .btn-custom {
            background: var(--accent);
            color: #fff;
            font-weight: 600;
        }

        .btn-custom:hover {
            background: var(--header);
            color: #fff;
        }

        .hint {
            color: #666;
            font-size: .9rem;
        }

        .accent-title {
            color: var(--accent);
            font-weight: 700;
        }
    </style>
</head>

<body>
    <div class="card login-card">
        <div class="login-header">
            <span class="brand-icon">üîß</span>
            <span>Iniciar sesi√≥n - Herramientas</span>
        </div>

        <div class="card-body p-4">
            <div class="text-center w-100 ">
                <h5 class="accent-title mb-3 text-center">Acceso seguro</h5>
            </div>
            
            <form id="loginForm" autocomplete="off" novalidate>
                <div class="mb-3">
                    <label for="usuario" class="form-label">Usuario</label>
                    <input type="text" id="usuario" class="form-control" autocomplete="off" required />
                </div>

                <div class="mb-3 position-relative">
                    <label for="password" class="form-label">Contrase√±a</label>
                    <div class="input-group">
                        <input type="password" id="password" class="form-control" autocomplete="new-password"
                            required />
                        <button class="btn btn-outline-secondary" type="button" id="togglePw" title="Mostrar / ocultar">
                            üëÅ
                        </button>
                    </div>
                </div>

                <div class="d-grid">
                    <button class="btn btn-custom" type="submit">Entrar</button>
                </div>

                <p id="errorMsg" class="text-danger text-center mt-3" style="display:none;">
                    ‚ùå Usuario o contrase√±a incorrectos
                </p>
            </form>
        </div>
    </div>

    <script>

        if (sessionStorage.getItem("isLoggedIn") === "true") {
            window.location.replace('Herramientas/Menu_Principal.html');
        }
        const USER_HASH = "8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918";
        const PASS_HASH = "4b63aee0fb4a5688f737d381cfecdf83b6a39bf9e6d758e2153458f838db2310";

        async function sha256hex(message) {
            const enc = new TextEncoder();
            const msgUint8 = enc.encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        document.getElementById('togglePw').addEventListener('click', () => {
            const pw = document.getElementById('password');
            pw.type = pw.type === 'password' ? 'text' : 'password';
        });

        document.getElementById('loginForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const userInput = document.getElementById('usuario').value.trim();
            const passInput = document.getElementById('password').value;

            if (!userInput || !passInput) {
                showError('Por favor completa ambos campos.');
                return;
            }

            try {
                const [uHash, pHash] = await Promise.all([sha256hex(userInput), sha256hex(passInput)]);
                if (uHash === USER_HASH && pHash === PASS_HASH) {
                    // acceso concedido (ahora usamos sessionStorage)
                    sessionStorage.setItem("isLoggedIn", "true");
                    alert('‚úÖ Bienvenido. Acceso concedido.');
                    window.location.href = 'Menu_Principal.html';
                } else {
                    showError('Usuario o contrase√±a incorrectos');
                }
            } catch (err) {
                console.error('Error al calcular hash:', err);
                showError('Error interno. Revisa la consola.');
            }
        });

        function showError(msg) {
            const el = document.getElementById('errorMsg');
            el.textContent = '‚ùå ' + msg;
            el.style.display = 'block';
            setTimeout(() => { el.style.display = 'none'; }, 5000);
        }

        
    </script>
</body>

</html>